# ScanSnapper インストールガイド

ScanSnapperは、USB接続のQRコードスキャナーから読み取ったデータを、アクティブなテキストフィールドに自動的にペーストするmacOSメニューバーアプリケーションです。

## 📋 必要な環境

- **macOS**: 12.0 (Monterey) 以降
- **USB QRコードスキャナー**: シリアルポート接続対応 (cu.usbmodem*)
- **権限**: アクセシビリティ権限（初回起動時に設定）

---

## 🚀 インストール手順

### ステップ1: ダウンロード

1. [GitHub Releases](https://github.com/NikoToRA/ScanSnapper_for_mac/releases/latest) から最新版をダウンロード
2. `ScanSnapper_v1.0.0.zip` をダウンロード

### ステップ2: ZIPファイルを解凍

1. ダウンロードした `ScanSnapper_v1.0.0.zip` をダブルクリック
2. `ScanSnapper.app` が展開されます

### ステップ3: アプリケーションフォルダにコピー

1. Finderで `アプリケーション` フォルダを開く
2. `ScanSnapper.app` を `アプリケーション` フォルダにドラッグ＆ドロップ

---

## ⚠️ 初回起動時の重要な手順

### セキュリティ警告の回避

初回起動時、以下のエラーが表示されます：

```
"ScanSnapper" は開発元が未確認のため開けません。
```

これは正常な動作です。以下の方法で回避してください：

#### 方法A: 右クリックから開く（推奨）

1. `ScanSnapper.app` を **右クリック**（または Control + クリック）
2. メニューから **「開く」** を選択
3. 警告ダイアログが表示されたら、再度 **「開く」** をクリック

#### 方法B: システム設定から許可

1. アプリをダブルクリックして警告を表示させる
2. **システム設定** を開く
3. **プライバシーとセキュリティ** を選択
4. セキュリティセクションで **「このまま開く」** をクリック

> **注意**: この手順は初回のみ必要です。一度許可すれば、以降は通常通りダブルクリックで起動できます。

---

## 🔐 アクセシビリティ権限の設定

ScanSnapperがキーボード入力を自動化するため、アクセシビリティ権限が必要です。

### 自動プロンプト方式

1. ScanSnapperを初回起動すると、権限リクエストダイアログが表示されます
2. **「システム設定を開く」** をクリック
3. **プライバシーとセキュリティ** > **アクセシビリティ** が開きます
4. **ScanSnapper** の横のチェックボックスをオンにします
5. 管理者パスワードの入力を求められた場合は入力してください

### 手動設定方式

自動プロンプトが表示されない場合：

1. **システム設定** を開く
2. **プライバシーとセキュリティ** を選択
3. 左側のリストから **アクセシビリティ** を選択
4. 右下の 🔒 をクリックしてロックを解除（管理者パスワードが必要）
5. **+** ボタンをクリック
6. **アプリケーション** フォルダから **ScanSnapper** を選択
7. **ScanSnapper** の横のチェックボックスがオンになっていることを確認

> **重要**: アクセシビリティ権限を付与しないと、自動ペースト機能が動作しません。

---

## 📱 基本的な使い方

### 起動確認

1. ScanSnapperを起動すると、メニューバーに **「QR」** というアイコンが表示されます
2. Dockにはアイコンは表示されません（メニューバー専用アプリ）

### USB QRスキャナーの接続

1. USB QRスキャナーをMacに接続
2. メニューバーの **QR** アイコンをクリック
3. **Port** メニューで接続されたポート（例: `cu.usbmodemW2306054321`）を選択
4. **Open Port** をクリック
5. ポートが開くと、アイコンが **📱✓** に変わります

> **自動接続**: ScanSnapperは起動時に自動的に最初のUSBモデムポートを検出して開きます。

### QRコードのスキャン

1. テキスト入力可能なアプリケーション（メモ帳、ブラウザのフォームなど）を開く
2. カーソルをテキストフィールドに配置
3. QRコードをスキャナーで読み取る
4. 読み取ったデータが自動的にテキストフィールドにペーストされます

---

## ⚙️ 設定オプション

メニューバーの **QR** アイコンをクリックして、以下の設定が可能です：

### Output Mode（出力モード）

- **Paste（推奨）**: クリップボード経由で貼り付け（高速・安定）
- **Type**: 1文字ずつキーボード入力をシミュレート（特殊なアプリケーション向け）

### Suffix（サフィックス）

スキャンデータの末尾に自動追加する文字：

- **None**: 追加なし
- **Tab**: タブキー
- **Enter**: エンターキー

> **使用例**: フォームで複数フィールドを順番に入力する場合、**Tab** を選択すると次のフィールドに自動移動します。

### Inter-char Delay（文字間遅延）

**Type** モードのみ有効。1文字ごとの入力間隔：

- **0ms**: 遅延なし（推奨）
- **5ms**: 5ミリ秒
- **10ms**: 10ミリ秒

> **注意**: 一部のアプリケーションで入力が正しく認識されない場合に、遅延を設定してください。

### Trailing LF（末尾改行）

スキャンデータの末尾の改行（LF）を保持するかどうか：

- **オフ（推奨）**: 末尾の改行を削除
- **オン**: 末尾の改行を保持

---

## 🛠️ トラブルシューティング

### メニューバーにアイコンが表示されない

1. **アクティビティモニタ** を開く
2. **ScanSnapper** が実行中か確認
3. 実行中でない場合、再度起動を試みる
4. それでも表示されない場合、一度 **ログアウト/ログイン** してください

### スキャンしてもペーストされない

#### チェック1: ポートが開いているか

- メニューバーアイコンが **📱✓** になっているか確認
- なっていない場合、**Port** メニューからポートを選択し、**Open Port** をクリック

#### チェック2: アクセシビリティ権限

1. **システム設定** > **プライバシーとセキュリティ** > **アクセシビリティ**
2. **ScanSnapper** がリストにあり、チェックがオンになっているか確認
3. オフの場合、チェックをオンにする
4. ScanSnapperを再起動

#### チェック3: 出力モード

- **Output Mode** が **Paste** になっているか確認
- **Type** モードで動作しない場合、**Paste** に変更してみてください

### 日本語が正しく表示されない

- ScanSnapperは **UTF-8** エンコーディングに対応しています
- スキャナー側のエンコーディング設定を確認してください
- ボーレートが **9600** になっているか確認してください

### ポートが "Resource busy" エラーになる

他のアプリケーションが同じポートを使用している可能性があります：

1. **ターミナル** を開く
2. 以下のコマンドでポートを使用しているプロセスを確認：
   ```bash
   lsof | grep cu.usbmodem
   ```
3. 該当プロセスを終了させる（PIDを確認して `kill <PID>`）
4. ScanSnapperでポートを再度開く

### アプリが起動しない

1. **コンソール.app** を開く
2. 左側のリストから自分のMacを選択
3. 検索欄に「ScanSnapper」と入力
4. エラーメッセージを確認
5. [GitHub Issues](https://github.com/NikoToRA/ScanSnapper_for_mac/issues) で報告してください

---

## 🔄 アップデート方法

新しいバージョンがリリースされた場合：

1. 古いバージョンの **ScanSnapper** を終了
2. [GitHub Releases](https://github.com/NikoToRA/ScanSnapper_for_mac/releases/latest) から最新版をダウンロード
3. 新しい `ScanSnapper.app` でアプリケーションフォルダの既存ファイルを置き換える
4. 再起動

> **設定の保持**: 設定はアプリ内に保存されているため、再設定が必要な場合があります。

---

## ❌ アンインストール方法

1. ScanSnapperを終了
2. **アプリケーション** フォルダから `ScanSnapper.app` をゴミ箱に移動
3. （オプション）**システム設定** > **プライバシーとセキュリティ** > **アクセシビリティ** から ScanSnapper を削除

---

## 📞 サポート

### 問題が解決しない場合

1. [GitHub Issues](https://github.com/NikoToRA/ScanSnapper_for_mac/issues) で既存の問題を検索
2. 見つからない場合、新しいIssueを作成：
   - 問題の詳細な説明
   - macOSバージョン
   - エラーメッセージ（あれば）
   - 再現手順

### リリースノート

各バージョンの変更内容は [Releases ページ](https://github.com/NikoToRA/ScanSnapper_for_mac/releases) で確認できます。

---

## 📄 ライセンス

このプロジェクトは MIT ライセンスの下で公開されています。

---

## 🙏 謝辞

ScanSnapperをご利用いただき、ありがとうございます！

バグ報告、機能リクエスト、プルリクエストを歓迎します。
